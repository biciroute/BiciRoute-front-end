{"ast":null,"code":"import _objectWithoutProperties from \"C:\\\\Users\\\\fduran\\\\Documents\\\\karen\\\\IETI\\\\proyecto\\\\BiciRoute-front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectWithoutProperties\";\nvar _jsxFileName = \"C:\\\\Users\\\\fduran\\\\Documents\\\\karen\\\\IETI\\\\proyecto\\\\BiciRoute-front-end\\\\src\\\\component\\\\Map\\\\MapComponent.js\";\nimport React from 'react';\nimport { GoogleApiWrapper, Map, Marker, Polyline } from 'google-maps-react';\nimport \"./Map.css\";\nimport Button from '@material-ui/core/Button';\nimport NavigationIcon from '@material-ui/icons/Navigation';\nimport Modal from '@material-ui/core/Modal';\nimport withStyles from \"@material-ui/core/styles/withStyles\";\nimport PropTypes from 'prop-types';\nimport TextField from '@material-ui/core/TextField';\nimport { flexbox } from '@material-ui/system';\nconst mapStyles = {\n  width: '100%',\n  height: '100%'\n};\n\nconst useStyles = theme => ({\n  paper: {\n    width: 400,\n    backgroundColor: theme.palette.background.paper,\n    border: '2px solid #000',\n    boxShadow: theme.shadows[5],\n    padding: theme.spacing(2, 4, 3)\n  },\n  textField: {\n    marginLeft: theme.spacing(1),\n    marginRight: theme.spacing(1),\n    width: 200\n  },\n  Modal: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center'\n  }\n});\n\nexport class MapComponent extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      university: {\n        lat: 4.782715,\n        lng: -74.042611\n      },\n      open: false,\n      pathRoute: [],\n      position: null\n    }; // Modal\n\n    this.handleClose = this.handleClose.bind(this);\n    this.handleOpen = this.handleOpen.bind(this); // Route\n\n    this.autocomplete = this.autocomplete.bind(this);\n    this.setDirectionRoute = this.setDirectionRoute.bind(this); //this.renderDirections =  this.renderDirections.bind(this);\n  }\n\n  setRefInput(ref) {\n    this.autocomplete = ref;\n  }\n\n  handleClose(e) {\n    this.setState({\n      open: false\n    });\n  }\n\n  rand() {\n    return Math.round(Math.random() * 20) - 10;\n  }\n\n  getModalStyle() {\n    const top = 50 + this.rand();\n    const left = 50 + this.rand();\n    return {\n      top: \"\".concat(top, \"%\"),\n      left: \"\".concat(left, \"%\"),\n      transform: \"translate(-\".concat(top, \"%, -\").concat(left, \"%)\")\n    };\n  }\n\n  handleOpen(e) {\n    this.setState({\n      open: true\n    });\n  }\n\n  async getLanLnt(address) {\n    const _this$props = this.props,\n          google = _this$props.google,\n          map = _this$props.map;\n    const geocoder = new google.maps.Geocoder();\n    return new Promise((resolve, reject) => {\n      geocoder.geocode({\n        'address': address\n      }, function (results, status) {\n        if (status == 'OK') {\n          resolve(results[0].geometry.location);\n        } else {\n          window.alert('Directions ' + address + ' request failed due to ' + status);\n          reject(status);\n        }\n      });\n    });\n  }\n\n  async getCenterMap() {\n    const _this$props2 = this.props,\n          google = _this$props2.google,\n          map = _this$props2.map;\n    const temporalRoutes = [];\n    const sourceRoute = document.getElementById(\"source\").value;\n    const targetRoute = document.getElementById(\"target\").value;\n    const coordinatesDestinations = [];\n    var x = await this.getLanLnt(sourceRoute);\n    var y = await this.getLanLnt(targetRoute);\n    coordinatesDestinations.push(x);\n    coordinatesDestinations.push(y);\n    var bounds = new google.maps.LatLngBounds();\n    console.log(\"aqui \" + coordinatesDestinations + \" \" + coordinatesDestinations.length);\n\n    for (var i = 0; i < coordinatesDestinations.length; i++) {\n      console.log(coordinatesDestinations[i].lat() + \" \" + coordinatesDestinations[i].lng());\n      var marker = new google.maps.Marker({\n        position: new google.maps.LatLng(coordinatesDestinations[i].lat(), coordinatesDestinations[i].lng()),\n        map: map\n      }); //extend the bounds to include each marker's position\n\n      bounds.extend(marker.position);\n    }\n\n    this.setState({\n      position: bounds.getCenter()\n    });\n    console.log(\"Aca   \" + bounds.getCenter());\n    map.fitBounds(bounds);\n    console.log(coordinatesDestinations);\n    return coordinatesDestinations;\n  }\n\n  async setDirectionRoute() {\n    var newPathRoute = await this.calculateRoute();\n    const _this$props3 = this.props,\n          google = _this$props3.google,\n          map = _this$props3.map;\n    this.setState({\n      pathRoute: newPathRoute.routes[0].overview_path,\n      open: false\n    });\n    this.getCenterMap();\n  }\n\n  autocomplete() {\n    const _this$props4 = this.props,\n          google = _this$props4.google,\n          map = _this$props4.map,\n          rest = _objectWithoutProperties(_this$props4, [\"google\", \"map\"]);\n\n    if (!google || !map) return;\n    var src = document.getElementById(\"source\");\n    var tgt = document.getElementById('target');\n    var autoSrc = new google.maps.places.Autocomplete(src);\n    var autoTgt = new google.maps.places.Autocomplete(tgt);\n    autoSrc.bindTo('bounds', map);\n    autoSrc.setFields(['address_components', 'geometry', 'icon', 'name']);\n    autoTgt.bindTo('bounds', map);\n    autoTgt.setFields(['address_components', 'geometry', 'icon', 'name']);\n    autoSrc.setComponentRestrictions({\n      'country': ['co']\n    });\n    autoTgt.setComponentRestrictions({\n      'country': ['co']\n    });\n  }\n\n  calculateRoute(travelMode, origin, destination, dateUniversity) {\n    const _this$props5 = this.props,\n          google = _this$props5.google,\n          map = _this$props5.map,\n          rest = _objectWithoutProperties(_this$props5, [\"google\", \"map\"]);\n\n    if (!google || !map) return;\n    const directionsService = new google.maps.DirectionsService();\n    let pathRoute;\n    const request = {\n      origin: document.getElementById(\"source\").value,\n      destination: document.getElementById(\"target\").value,\n      travelMode: \"DRIVING\"\n    };\n    return new Promise((resolve, reject) => {\n      directionsService.route(request, (response, status) => {\n        if (status === 'OK') {\n          window.alert(\"OK PASS\");\n          pathRoute = response.routes[0];\n          resolve(response);\n        } else {\n          window.alert('Directions request failed due to ' + status);\n          reject(status);\n        }\n      });\n    });\n  } //https://stackoverflow.com/questions/26059762/callback-when-dom-is-loaded-in-react-js\n\n\n  componentDidMount() {\n    this.autocomplete();\n\n    if (navigator && navigator.geolocation) {//navigator.geolocation.getCurrentPosition(this.setCurrentPosition)\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.map !== prevProps.map) {\n      this.autocomplete();\n    }\n  } // getModalStyle is not a pure function, we roll the style only on the first render\n\n\n  render() {\n    const classes = this.props.classes;\n    const modalStyle = this.getModalStyle;\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233\n      },\n      __self: this\n    }, React.createElement(Map, {\n      className: \"map\",\n      google: this.props.google,\n      zoom: 15,\n      style: mapStyles,\n      initialCenter: this.state.university,\n      centerAroundCurrentLocation: false,\n      mapTypeControl: false,\n      center: this.state.position,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234\n      },\n      __self: this\n    }, React.createElement(Marker, {\n      title: 'Escuela colombiana de ingenieria Julio Garavito',\n      position: this.state.university,\n      animation: this.props.google.maps.Animation.DROP,\n      name: 'Escuela colombiana de ingenieria Julio Garavito',\n      description: 'AK 45 #205-59 Bogota\\nInstitucion universitaria',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246\n      },\n      __self: this\n    }), React.createElement(Polyline, {\n      path: this.state.pathRoute,\n      geodesic: false,\n      options: {\n        strokeColor: '#38B44F',\n        strokeOpacity: 1,\n        strokeWeight: 7\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255\n      },\n      __self: this\n    }), React.createElement(Button, {\n      title: \"Begin your route with biciRoute\",\n      variant: \"contained\",\n      color: \"primary\",\n      onClick: this.handleOpen,\n      id: \"buttonSearch\",\n      \"aria-label\": \"delete\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264\n      },\n      __self: this\n    }, React.createElement(NavigationIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265\n      },\n      __self: this\n    }), \" Search trip\")), React.createElement(Modal, {\n      open: this.state.open,\n      onClose: this.handleClose,\n      keepMounted: true,\n      id: \"modal\" //style={modalStyle}\n      ,\n      className: classes.Modal,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: classes.paper,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280\n      },\n      __self: this\n    }, React.createElement(TextField, {\n      id: \"source\",\n      type: \"search\",\n      label: \"trip's start\",\n      className: classes.textField,\n      margin: \"normal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289\n      },\n      __self: this\n    }), React.createElement(TextField, {\n      id: \"target\",\n      type: \"search\",\n      label: \"trip's end\",\n      className: classes.textField,\n      margin: \"normal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 297\n      },\n      __self: this\n    }), React.createElement(Button, {\n      variant: \"contained\",\n      color: \"primary\",\n      onClick: this.setDirectionRoute,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 298\n      },\n      __self: this\n    }, \"Search possible trips\"))));\n  }\n\n} //https://es.reactjs.org/docs/hooks-reference.html#usestate\n\nMapComponent.propTypes = {\n  classes: PropTypes.object.isRequired\n};\n\nconst MapWrapper = props => React.createElement(\"div\", {\n  className: \"unAbsolute\",\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 316\n  },\n  __self: this\n}, React.createElement(Map, {\n  className: \"map\",\n  google: props.google,\n  visible: false,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 317\n  },\n  __self: this\n}, React.createElement(MapComponent, Object.assign({}, props, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 318\n  },\n  __self: this\n}))));\n\nexport default withStyles(useStyles)(GoogleApiWrapper({\n  apiKey: 'AIzaSyCJuZIQnX6XR1vs6dBHuZHj8J5TrWmVi-8',\n  language: \"es\"\n})(MapWrapper));","map":{"version":3,"sources":["C:\\Users\\fduran\\Documents\\karen\\IETI\\proyecto\\BiciRoute-front-end\\src\\component\\Map\\MapComponent.js"],"names":["React","GoogleApiWrapper","Map","Marker","Polyline","Button","NavigationIcon","Modal","withStyles","PropTypes","TextField","flexbox","mapStyles","width","height","useStyles","theme","paper","backgroundColor","palette","background","border","boxShadow","shadows","padding","spacing","textField","marginLeft","marginRight","display","alignItems","justifyContent","MapComponent","Component","constructor","props","state","university","lat","lng","open","pathRoute","position","handleClose","bind","handleOpen","autocomplete","setDirectionRoute","setRefInput","ref","e","setState","rand","Math","round","random","getModalStyle","top","left","transform","getLanLnt","address","google","map","geocoder","maps","Geocoder","Promise","resolve","reject","geocode","results","status","geometry","location","window","alert","getCenterMap","temporalRoutes","sourceRoute","document","getElementById","value","targetRoute","coordinatesDestinations","x","y","push","bounds","LatLngBounds","console","log","length","i","marker","LatLng","extend","getCenter","fitBounds","newPathRoute","calculateRoute","routes","overview_path","rest","src","tgt","autoSrc","places","Autocomplete","autoTgt","bindTo","setFields","setComponentRestrictions","travelMode","origin","destination","dateUniversity","directionsService","DirectionsService","request","route","response","componentDidMount","navigator","geolocation","componentDidUpdate","prevProps","render","classes","modalStyle","Animation","DROP","strokeColor","strokeOpacity","strokeWeight","propTypes","object","isRequired","MapWrapper","apiKey","language"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { GoogleApiWrapper, Map, Marker, Polyline } from 'google-maps-react';\r\nimport \"./Map.css\"\r\nimport Button from '@material-ui/core/Button';\r\nimport NavigationIcon from '@material-ui/icons/Navigation';\r\nimport Modal from '@material-ui/core/Modal';\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport PropTypes from 'prop-types';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport { flexbox } from '@material-ui/system';\r\n\r\n\r\n\r\n\r\nconst mapStyles = {\r\n    width: '100%',\r\n    height: '100%',\r\n};\r\n\r\n\r\nconst useStyles = theme => ({\r\n    paper: {\r\n        width: 400,\r\n        backgroundColor: theme.palette.background.paper,\r\n        border: '2px solid #000',\r\n        boxShadow: theme.shadows[5],\r\n        padding: theme.spacing(2, 4, 3),\r\n    },\r\n    textField: {\r\n        marginLeft: theme.spacing(1),\r\n        marginRight: theme.spacing(1),\r\n        width: 200,\r\n    },\r\n    Modal: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n\r\n    }\r\n\r\n});\r\n\r\nexport class MapComponent extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            university: { lat: 4.782715, lng: -74.042611 },\r\n            open: false,\r\n            pathRoute: [],\r\n            position: null\r\n        };\r\n\r\n        // Modal\r\n        this.handleClose = this.handleClose.bind(this);\r\n        this.handleOpen = this.handleOpen.bind(this);\r\n        // Route\r\n        this.autocomplete = this.autocomplete.bind(this);\r\n        this.setDirectionRoute = this.setDirectionRoute.bind(this);\r\n        //this.renderDirections =  this.renderDirections.bind(this);\r\n\r\n    }\r\n\r\n    setRefInput(ref) {\r\n        this.autocomplete = ref;\r\n    }\r\n\r\n    handleClose(e) {\r\n        this.setState({\r\n            open: false\r\n        });\r\n    }\r\n\r\n    rand() {\r\n        return Math.round(Math.random() * 20) - 10;\r\n    }\r\n\r\n    getModalStyle() {\r\n        const top = 50 + this.rand();\r\n        const left = 50 + this.rand();\r\n        return {\r\n            top: `${top}%`,\r\n            left: `${left}%`,\r\n            transform: `translate(-${top}%, -${left}%)`,\r\n        };\r\n    }\r\n\r\n    handleOpen(e) {\r\n        this.setState({\r\n            open: true\r\n        })\r\n    }\r\n\r\n    async getLanLnt(address) {\r\n        const { google, map } = this.props;\r\n        const geocoder = new google.maps.Geocoder();\r\n        return new Promise((resolve, reject) => {\r\n            geocoder.geocode({ 'address': address }, function (results, status) {\r\n                if (status == 'OK') {\r\n\r\n                    resolve(results[0].geometry.location)\r\n                } else {\r\n                    window.alert('Directions ' + address + ' request failed due to ' + status);\r\n                    reject(status)\r\n                }\r\n            });\r\n        })\r\n    }\r\n\r\n    async getCenterMap() {\r\n\r\n        const { google, map } = this.props;\r\n        const temporalRoutes = []\r\n        const sourceRoute = document.getElementById(\"source\").value\r\n        const targetRoute = document.getElementById(\"target\").value\r\n        const coordinatesDestinations = []\r\n        var x = await this.getLanLnt(sourceRoute)\r\n        var y = await this.getLanLnt(targetRoute)\r\n        coordinatesDestinations.push(x);\r\n        coordinatesDestinations.push(y);\r\n        var bounds = new google.maps.LatLngBounds();     \r\n        console.log(\"aqui \" + coordinatesDestinations + \" \" + coordinatesDestinations.length)\r\n        for (var i = 0; i < coordinatesDestinations.length; i++) {\r\n            console.log(coordinatesDestinations[i].lat()+ \" \" + coordinatesDestinations[i].lng());\r\n            \r\n            var marker = new google.maps.Marker({\r\n                position: new google.maps.LatLng(coordinatesDestinations[i].lat(), coordinatesDestinations[i].lng()),\r\n                map: map\r\n            });\r\n            //extend the bounds to include each marker's position\r\n            bounds.extend(marker.position);\r\n\r\n        }\r\n        this.setState({\r\n            position : bounds.getCenter()\r\n        });\r\n        console.log(\"Aca   \"  + bounds.getCenter());\r\n        map.fitBounds(bounds);\r\n        \r\n\r\n        console.log(coordinatesDestinations);\r\n        return coordinatesDestinations\r\n    }\r\n\r\n\r\n    async setDirectionRoute() {\r\n        var newPathRoute = await this.calculateRoute();\r\n        const { google, map } = this.props;\r\n        this.setState({\r\n            pathRoute: newPathRoute.routes[0].overview_path,\r\n            open: false\r\n        });\r\n        this.getCenterMap();\r\n        \r\n    }\r\n\r\n\r\n    autocomplete() {\r\n        const { google, map, ...rest } = this.props;\r\n        if (!google || !map) return;\r\n        var src = document.getElementById(\"source\");\r\n        var tgt = document.getElementById('target');\r\n        var autoSrc = new google.maps.places.Autocomplete(src);\r\n        var autoTgt = new google.maps.places.Autocomplete(tgt);\r\n        autoSrc.bindTo('bounds', map);\r\n        autoSrc.setFields(['address_components', 'geometry', 'icon', 'name']);\r\n        autoTgt.bindTo('bounds', map);\r\n        autoTgt.setFields(['address_components', 'geometry', 'icon', 'name']);\r\n\r\n        autoSrc.setComponentRestrictions(\r\n            { 'country': ['co'] });\r\n        autoTgt.setComponentRestrictions(\r\n            { 'country': ['co'] });\r\n\r\n\r\n    }\r\n\r\n\r\n    calculateRoute(travelMode, origin, destination, dateUniversity) {\r\n        const { google, map, ...rest } = this.props;\r\n        if (!google || !map) return;\r\n        const directionsService = new google.maps.DirectionsService();\r\n        let pathRoute;\r\n        const request = {\r\n            origin: document.getElementById(\"source\").value,\r\n            destination: document.getElementById(\"target\").value,\r\n            travelMode: \"DRIVING\",\r\n        };\r\n        return new Promise((resolve, reject) => {\r\n            directionsService.route(request, (response, status) => {\r\n                if (status === 'OK') {\r\n                    window.alert(\"OK PASS\");\r\n                    pathRoute = response.routes[0];\r\n                    resolve(response)\r\n                } else {\r\n\r\n                    window.alert('Directions request failed due to ' + status);\r\n                    reject(status)\r\n                }\r\n            })\r\n        }\r\n        )\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    //https://stackoverflow.com/questions/26059762/callback-when-dom-is-loaded-in-react-js\r\n    componentDidMount() {\r\n        this.autocomplete();\r\n        if (navigator && navigator.geolocation) {\r\n            //navigator.geolocation.getCurrentPosition(this.setCurrentPosition)\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps) {\r\n        if (this.props.map !== prevProps.map) {\r\n            this.autocomplete();\r\n\r\n        }\r\n\r\n\r\n    }\r\n\r\n\r\n    // getModalStyle is not a pure function, we roll the style only on the first render\r\n\r\n    render() {\r\n        const { classes } = this.props;\r\n        const modalStyle = this.getModalStyle;\r\n        return (\r\n            <div >\r\n                <Map\r\n                    className=\"map\"\r\n                    google={this.props.google}\r\n                    zoom={15}\r\n                    style={mapStyles}\r\n                    initialCenter={this.state.university}\r\n                    centerAroundCurrentLocation={false}\r\n                    mapTypeControl={false}\r\n                    center={this.state.position}\r\n\r\n                >\r\n\r\n                    <Marker\r\n                        title={'Escuela colombiana de ingenieria Julio Garavito'}\r\n                        position={this.state.university}\r\n                        animation={this.props.google.maps.Animation.DROP}\r\n                        name={'Escuela colombiana de ingenieria Julio Garavito'}\r\n                        description={'AK 45 #205-59 Bogota\\nInstitucion universitaria'}\r\n                    />\r\n\r\n\r\n                    <Polyline\r\n                        path={this.state.pathRoute}\r\n                        geodesic={false}\r\n                        options={{\r\n                            strokeColor: '#38B44F',\r\n                            strokeOpacity: 1,\r\n                            strokeWeight: 7,\r\n                        }}\r\n                    />\r\n                    <Button title=\"Begin your route with biciRoute\" variant=\"contained\" color=\"primary\" onClick={this.handleOpen} id=\"buttonSearch\" aria-label=\"delete\" >\r\n                        <NavigationIcon /> Search trip\r\n                    </Button>\r\n\r\n\r\n                </Map>\r\n\r\n\r\n\r\n                <Modal open={this.state.open}\r\n                    onClose={this.handleClose}\r\n                    keepMounted={true}\r\n                    id=\"modal\"\r\n                    //style={modalStyle}\r\n                    className = {classes.Modal}\r\n                >\r\n                    <div className={classes.paper}>\r\n                        <TextField\r\n                            id=\"source\"\r\n                            type=\"search\"\r\n                            label=\"trip's start\"\r\n                            className={classes.textField}\r\n                            margin=\"normal\"\r\n                        />\r\n\r\n                        <br></br>\r\n                        <TextField\r\n                            id=\"target\"\r\n                            type=\"search\"\r\n                            label=\"trip's end\"\r\n                            className={classes.textField}\r\n                            margin=\"normal\"\r\n                        />\r\n                        <br></br>\r\n                        <Button variant=\"contained\" color=\"primary\" onClick={this.setDirectionRoute}>\r\n                            Search possible trips\r\n                        </Button>\r\n\r\n                    </div>\r\n                </Modal>\r\n\r\n            </div>\r\n        );\r\n    }\r\n\r\n}\r\n//https://es.reactjs.org/docs/hooks-reference.html#usestate\r\nMapComponent.propTypes = {\r\n    classes: PropTypes.object.isRequired,\r\n};\r\n\r\nconst MapWrapper = props => (\r\n    <div className=\"unAbsolute\">\r\n        <Map className=\"map\" google={props.google} visible={false}>\r\n            <MapComponent {...props} />\r\n        </Map>\r\n    </div>\r\n);\r\n\r\nexport default withStyles(useStyles)(GoogleApiWrapper({\r\n    apiKey: 'AIzaSyCJuZIQnX6XR1vs6dBHuZHj8J5TrWmVi-8',\r\n    language: \"es\",\r\n})(MapWrapper));"]},"metadata":{},"sourceType":"module"}