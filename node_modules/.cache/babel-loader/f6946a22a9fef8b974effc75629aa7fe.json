{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\fduran\\\\Documents\\\\karen\\\\IETI\\\\proyecto\\\\BiciRoute-front-end\\\\src\\\\component\\\\Map\\\\MapComponent.js\";\nimport React from 'react';\nimport { GoogleApiWrapper, Map, Marker, Polyline } from 'google-maps-react';\nimport \"./Map.css\";\nimport NavigationIcon from '@material-ui/icons/Navigation';\nimport withStyles from \"@material-ui/core/styles/withStyles\";\nimport PropTypes from 'prop-types';\nimport { fade } from '@material-ui/core/styles';\nimport Fab from '@material-ui/core/Fab';\nimport SearchBar from './SearchBar.js';\nconst mapStyles = {\n  width: '100%',\n  height: '100%'\n};\n\nconst useStyles = theme => ({\n  paper: {\n    width: \"100%\",\n    backgroundColor: theme.palette.background.paper,\n    border: '2px solid #000',\n    boxShadow: theme.shadows[5],\n    padding: theme.spacing(2, 4, 3)\n  },\n  textField: {\n    position: \"relative\",\n    borderRadius: theme.shape.borderRadius,\n    backgroundColor: fade(theme.palette.common.white, 0.15),\n    \"&:hover\": {\n      backgroundColor: fade(theme.palette.common.white, 0.25)\n    },\n    marginLeft: 0,\n    width: \"100%\",\n    [theme.breakpoints.up(\"sm\")]: {\n      marginLeft: theme.spacing(2),\n      width: \"auto\"\n    }\n  },\n  Modal: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center'\n  },\n  list: {\n    width: 250\n  },\n  fullList: {\n    width: 'auto'\n  }\n});\n\nexport class MapComponent extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      university: {\n        lat: 4.782715,\n        lng: -74.042611\n      },\n      open: false,\n      pathRoute: [],\n      pathRouteOriginPlace: [],\n      pathRouteDestinationPlace: [],\n      position: null,\n      markers: [{\n        university: {\n          lat: 4.782715,\n          lng: -74.042611\n        },\n        title: \"Escuela colombiana de ingenieria Julio Garavito\",\n        name: \"Escuela colombiana de ingenieria Julio Garavito\"\n      }],\n      carres: [\"Calle 100, Troncal Autopista Norte, Cundinamarca, Colombia\", \"Parque Nacional, Calle 36, Bogotá, Colombia\", \"Virrey Solis Castellana, Autopista Norte, Bogotá, Colombia\"]\n    }; // Route\n\n    this.autocomplete = this.autocomplete.bind(this);\n    this.setDirectionRoute = this.setDirectionRoute.bind(this); //this.renderDirections =  this.renderDirections.bind(this);\n\n    this.handleClose = this.handleClose.bind(this);\n    this.handleOpen = this.handleOpen.bind(this);\n  }\n\n  handleOpen(e) {\n    this.setState({\n      open: true\n    });\n  }\n\n  handleClose(e) {\n    this.setState({\n      open: false\n    });\n  }\n\n  async getLanLnt(address) {\n    const google = this.props.google;\n    const geocoder = new google.maps.Geocoder();\n    return new Promise((resolve, reject) => {\n      geocoder.geocode({\n        'address': address\n      }, function (results, status) {\n        if (status === 'OK') {\n          resolve(results[0].geometry.location);\n        } else {\n          window.alert('Directions ' + address + ' request failed due to ' + status);\n          reject(status);\n        }\n      });\n    });\n  }\n\n  async getCenterMap(sourceRoute, targetRoute) {\n    const _this$props = this.props,\n          google = _this$props.google,\n          map = _this$props.map;\n    const coordinatesDestinations = [];\n    var x = await this.getLanLnt(sourceRoute);\n    var y = await this.getLanLnt(targetRoute);\n    coordinatesDestinations.push(x);\n    coordinatesDestinations.push(y);\n    var bounds = new google.maps.LatLngBounds();\n\n    for (var i = 0; i < coordinatesDestinations.length; i++) {\n      var marker = new google.maps.Marker({\n        position: new google.maps.LatLng(coordinatesDestinations[i].lat(), coordinatesDestinations[i].lng()),\n        map: map\n      });\n      bounds.extend(marker.position);\n    }\n\n    this.setState({\n      position: bounds.getCenter()\n    });\n    map.fitBounds(bounds);\n    return coordinatesDestinations;\n  }\n\n  async setDirectionRoute() {\n    const origin = document.getElementById(\"source\").value;\n    const destination = document.getElementById(\"target\").value; //Define route the  shortest of the origin to some place \n\n    var theBestOriginToPlace = [1e9, \"undefine\", null];\n    var theBestDestinationToPlace = [1e9, \"undefine\", null];\n\n    for (var i = 0; i < this.state.carres.length; i++) {\n      var place = this.state.carres[i];\n      var newPathRoute = await this.calculateRoute(origin, place);\n      var distance = newPathRoute.routes[0].legs[0].distance.text;\n      distance = parseFloat(distance.split(\" \")[0].replace(\",\", \".\"));\n\n      if (distance < theBestOriginToPlace[0]) {\n        theBestOriginToPlace[1] = place;\n        theBestOriginToPlace[0] = Math.min(distance, theBestOriginToPlace[0]);\n        theBestOriginToPlace[2] = newPathRoute.routes[0].overview_path;\n      }\n    }\n\n    console.log(destination);\n\n    for (i = 0; i < this.state.carres.length; i++) {\n      place = this.state.carres[i]; //if(place === theBestOriginToPlace[1])continue;\n\n      try {\n        newPathRoute = await this.calculateRoute(destination, place);\n        distance = newPathRoute.routes[0].legs[0].distance.text;\n        distance = parseFloat(distance.split(\" \")[0].replace(\",\", \".\"));\n\n        if (distance < theBestDestinationToPlace[0]) {\n          theBestDestinationToPlace[1] = place;\n          theBestDestinationToPlace[0] = Math.min(distance, theBestDestinationToPlace[0]);\n          theBestDestinationToPlace[2] = newPathRoute.routes[0].overview_path;\n        }\n      } catch (error) {}\n    }\n\n    console.log(theBestOriginToPlace[1], theBestDestinationToPlace[1]);\n    newPathRoute = await this.calculateRoute(theBestDestinationToPlace[1], theBestOriginToPlace[1]);\n    this.setState({\n      pathRoute: newPathRoute.routes[0].overview_path,\n      pathRouteDestinationPlace: theBestDestinationToPlace[2],\n      pathRouteOriginPlace: theBestOriginToPlace[2],\n      open: false\n    });\n    var newJSON = JSON.stringify({\n      origin: origin,\n      destination: destination,\n      pathRouteDestinationPlace: theBestDestinationToPlace[1],\n      pathRouteOriginPlace: theBestOriginToPlace[1]\n    });\n\n    if (localStorage.getItem('lastroutes') === undefined || localStorage.getItem('lastroutes') === null) {\n      localStorage.setItem('lastroutes', JSON.stringify([newJSON]));\n    } else {\n      var tdListJSON = [];\n      var tdLists = JSON.parse(localStorage.getItem(\"lastroutes\"));\n\n      for (var i = 0; i < tdLists.length; ++i) {\n        tdListJSON.push(tdLists[i]);\n      }\n\n      tdListJSON.push(newJSON);\n      localStorage.setItem(\"lastroutes\", JSON.stringify(tdListJSON));\n    }\n\n    const places = [origin, destination, theBestDestinationToPlace[1], theBestOriginToPlace[1]];\n    this.setState({\n      markers: []\n    });\n\n    for (i = 0; i < 4; ++i) {\n      const latAndLng = await this.getLanLnt(places[i]);\n      const newMarker = {\n        university: {\n          lat: latAndLng.lat(),\n          lng: latAndLng.lng()\n        },\n        title: places[i],\n        name: places[i]\n      };\n      this.state.markers.push(newMarker);\n    }\n\n    console.log(this.state.markers);\n    this.getCenterMap(origin, destination);\n  }\n\n  autocomplete() {\n    const _this$props2 = this.props,\n          google = _this$props2.google,\n          map = _this$props2.map;\n    if (!google || !map) return;\n    var src = document.getElementById(\"source\");\n    var tgt = document.getElementById('target');\n    var autoSrc = new google.maps.places.Autocomplete(src);\n    var autoTgt = new google.maps.places.Autocomplete(tgt);\n    autoSrc.bindTo('bounds', map);\n    autoSrc.setFields(['address_components', 'geometry', 'icon', 'name']);\n    autoTgt.bindTo('bounds', map);\n    autoTgt.setFields(['address_components', 'geometry', 'icon', 'name']);\n    autoSrc.setComponentRestrictions({\n      'country': ['co']\n    });\n    autoTgt.setComponentRestrictions({\n      'country': ['co']\n    });\n  }\n\n  calculateRoute(origin, destination) {\n    const _this$props3 = this.props,\n          google = _this$props3.google,\n          map = _this$props3.map;\n    if (!google || !map) return;\n    const directionsService = new google.maps.DirectionsService();\n    const request = {\n      origin: origin,\n      destination: destination,\n      travelMode: \"DRIVING\",\n      provideRouteAlternatives: true\n    };\n    return new Promise((resolve, reject) => {\n      directionsService.route(request, (response, status) => {\n        if (status === 'OK') {\n          console.log(response);\n          resolve(response);\n        } else {\n          window.alert(destination + \" ----- \" + origin);\n          window.alert('Directions request failed due to ' + status);\n          reject(status);\n        }\n      });\n    });\n  } //https://stackoverflow.com/questions/26059762/callback-when-dom-is-loaded-in-react-js\n\n\n  componentDidMount() {\n    this.autocomplete();\n\n    if (navigator && navigator.geolocation) {//navigator.geolocation.getCurrentPosition(this.setCurrentPosition)\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.map !== prevProps.map) {\n      this.autocomplete();\n    }\n  }\n\n  render() {\n    const classes = this.props.classes;\n    const mark = this.state.markers.map(td => React.createElement(Marker, {\n      title: td.title,\n      position: td.university,\n      animation: this.props.google.maps.Animation.DROP,\n      name: td.name,\n      description: td.description,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290\n      },\n      __self: this\n    }));\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300\n      },\n      __self: this\n    }, React.createElement(SearchBar, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 301\n      },\n      __self: this\n    }), React.createElement(Map, {\n      className: \"map\",\n      google: this.props.google,\n      zoom: 15,\n      style: mapStyles,\n      initialCenter: this.state.university,\n      centerAroundCurrentLocation: false,\n      mapTypeControl: false,\n      center: this.state.position,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303\n      },\n      __self: this\n    }, mark, React.createElement(Polyline, {\n      path: this.state.pathRoute,\n      geodesic: true,\n      options: {\n        strokeColor: '#354BD9',\n        strokeOpacity: 1,\n        strokeWeight: 2\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317\n      },\n      __self: this\n    }), React.createElement(Polyline, {\n      path: this.state.pathRouteDestinationPlace,\n      geodesic: true,\n      options: {\n        strokeColor: '#38B44F',\n        strokeOpacity: 1,\n        strokeWeight: 2\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 328\n      },\n      __self: this\n    }), React.createElement(Polyline, {\n      path: this.state.pathRouteOriginPlace,\n      geodesic: true,\n      options: {\n        strokeColor: '#38B44F',\n        strokeOpacity: 1,\n        strokeWeight: 2\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 338\n      },\n      __self: this\n    }), React.createElement(Fab, {\n      id: \"fab\",\n      color: \"primary\",\n      \"aria-label\": \"add\",\n      className: classes.fab,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 348\n      },\n      __self: this\n    }, React.createElement(NavigationIcon, {\n      onClick: this.setDirectionRoute,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 349\n      },\n      __self: this\n    }))));\n  }\n\n} //https://es.reactjs.org/docs/hooks-reference.html#usestate\n\nMapComponent.propTypes = {\n  classes: PropTypes.object.isRequired\n};\n\nconst MapWrapper = props => React.createElement(\"div\", {\n  className: \"unAbsolute\",\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 364\n  },\n  __self: this\n}, React.createElement(Map, {\n  className: \"map\",\n  google: props.google,\n  visible: false,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 365\n  },\n  __self: this\n}, React.createElement(MapComponent, Object.assign({}, props, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 366\n  },\n  __self: this\n}))));\n\nexport default withStyles(useStyles)(GoogleApiWrapper({\n  apiKey: 'AIzaSyCJuZIQnX6XR1vs6dBHuZHj8J5TrWmVi-8',\n  language: \"es\"\n})(MapWrapper));","map":{"version":3,"sources":["C:\\Users\\fduran\\Documents\\karen\\IETI\\proyecto\\BiciRoute-front-end\\src\\component\\Map\\MapComponent.js"],"names":["React","GoogleApiWrapper","Map","Marker","Polyline","NavigationIcon","withStyles","PropTypes","fade","Fab","SearchBar","mapStyles","width","height","useStyles","theme","paper","backgroundColor","palette","background","border","boxShadow","shadows","padding","spacing","textField","position","borderRadius","shape","common","white","marginLeft","breakpoints","up","Modal","display","alignItems","justifyContent","list","fullList","MapComponent","Component","constructor","props","state","university","lat","lng","open","pathRoute","pathRouteOriginPlace","pathRouteDestinationPlace","markers","title","name","carres","autocomplete","bind","setDirectionRoute","handleClose","handleOpen","e","setState","getLanLnt","address","google","geocoder","maps","Geocoder","Promise","resolve","reject","geocode","results","status","geometry","location","window","alert","getCenterMap","sourceRoute","targetRoute","map","coordinatesDestinations","x","y","push","bounds","LatLngBounds","i","length","marker","LatLng","extend","getCenter","fitBounds","origin","document","getElementById","value","destination","theBestOriginToPlace","theBestDestinationToPlace","place","newPathRoute","calculateRoute","distance","routes","legs","text","parseFloat","split","replace","Math","min","overview_path","console","log","error","newJSON","JSON","stringify","localStorage","getItem","undefined","setItem","tdListJSON","tdLists","parse","places","latAndLng","newMarker","src","tgt","autoSrc","Autocomplete","autoTgt","bindTo","setFields","setComponentRestrictions","directionsService","DirectionsService","request","travelMode","provideRouteAlternatives","route","response","componentDidMount","navigator","geolocation","componentDidUpdate","prevProps","render","classes","mark","td","Animation","DROP","description","strokeColor","strokeOpacity","strokeWeight","fab","propTypes","object","isRequired","MapWrapper","apiKey","language"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { GoogleApiWrapper, Map, Marker, Polyline } from 'google-maps-react';\r\nimport \"./Map.css\";\r\nimport NavigationIcon from '@material-ui/icons/Navigation';\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport PropTypes from 'prop-types';\r\nimport { fade } from '@material-ui/core/styles';\r\nimport Fab from '@material-ui/core/Fab';\r\nimport SearchBar from './SearchBar.js';\r\n\r\nconst mapStyles = {\r\n    width: '100%',\r\n    height: '100%',\r\n};\r\n\r\n\r\nconst useStyles = theme => ({\r\n    paper: {\r\n        width: \"100%\",\r\n        backgroundColor: theme.palette.background.paper,\r\n        border: '2px solid #000',\r\n        boxShadow: theme.shadows[5],\r\n        padding: theme.spacing(2, 4, 3),\r\n    },\r\n    textField: {\r\n        position: \"relative\",\r\n        borderRadius: theme.shape.borderRadius,\r\n        backgroundColor: fade(theme.palette.common.white, 0.15),\r\n        \"&:hover\": {\r\n            backgroundColor: fade(theme.palette.common.white, 0.25)\r\n        },\r\n        marginLeft: 0,\r\n        width: \"100%\",\r\n        [theme.breakpoints.up(\"sm\")]: {\r\n            marginLeft: theme.spacing(2),\r\n            width: \"auto\"\r\n        },\r\n\r\n    },\r\n    Modal: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n\r\n    },\r\n  \r\n    list: {\r\n        width: 250,\r\n    },\r\n    fullList: {\r\n        width: 'auto',\r\n    },\r\n\r\n});\r\n\r\n\r\nexport class MapComponent extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            university: { lat: 4.782715, lng: -74.042611 },\r\n            open: false,\r\n            pathRoute: [],\r\n            pathRouteOriginPlace: [],\r\n            pathRouteDestinationPlace: [],\r\n            position: null,\r\n            markers: [\r\n                {\r\n                    university: { lat: 4.782715, lng: -74.042611 },\r\n                    title: \"Escuela colombiana de ingenieria Julio Garavito\",\r\n                    name: \"Escuela colombiana de ingenieria Julio Garavito\",\r\n                },\r\n            ],\r\n            carres: [\r\n                \"Calle 100, Troncal Autopista Norte, Cundinamarca, Colombia\",\r\n                \"Parque Nacional, Calle 36, Bogotá, Colombia\",\r\n                \"Virrey Solis Castellana, Autopista Norte, Bogotá, Colombia\",\r\n            ]\r\n        };\r\n\r\n        // Route\r\n        this.autocomplete = this.autocomplete.bind(this);\r\n        this.setDirectionRoute = this.setDirectionRoute.bind(this);\r\n        //this.renderDirections =  this.renderDirections.bind(this);\r\n        this.handleClose = this.handleClose.bind(this);\r\n        this.handleOpen = this.handleOpen.bind(this);\r\n    }\r\n\r\n    handleOpen(e) {\r\n        this.setState({ open: true });\r\n    }\r\n\r\n    handleClose(e) {\r\n        this.setState({ open: false });\r\n    }\r\n\r\n\r\n\r\n\r\n    async getLanLnt(address) {\r\n        const { google } = this.props;\r\n        const geocoder = new google.maps.Geocoder();\r\n        return new Promise((resolve, reject) => {\r\n            geocoder.geocode({ 'address': address }, function (results, status) {\r\n                if (status === 'OK') {\r\n                    resolve(results[0].geometry.location)\r\n                } else {\r\n                    window.alert('Directions ' + address + ' request failed due to ' + status);\r\n                    reject(status)\r\n                }\r\n            });\r\n        })\r\n    }\r\n\r\n    async getCenterMap(sourceRoute, targetRoute) {\r\n        const { google, map } = this.props;\r\n        const coordinatesDestinations = []\r\n        var x = await this.getLanLnt(sourceRoute)\r\n        var y = await this.getLanLnt(targetRoute)\r\n        coordinatesDestinations.push(x);\r\n        coordinatesDestinations.push(y);\r\n        var bounds = new google.maps.LatLngBounds();\r\n        for (var i = 0; i < coordinatesDestinations.length; i++) {\r\n            var marker = new google.maps.Marker({\r\n                position: new google.maps.LatLng(coordinatesDestinations[i].lat(), coordinatesDestinations[i].lng()),\r\n                map: map\r\n            });\r\n            bounds.extend(marker.position);\r\n        }\r\n        this.setState({\r\n            position: bounds.getCenter()\r\n        });\r\n        map.fitBounds(bounds);\r\n        return coordinatesDestinations\r\n    }\r\n\r\n\r\n    async setDirectionRoute() {\r\n        const origin = document.getElementById(\"source\").value;\r\n        const destination = document.getElementById(\"target\").value;\r\n        //Define route the  shortest of the origin to some place \r\n        var theBestOriginToPlace = [1e9, \"undefine\", null];\r\n        var theBestDestinationToPlace = [1e9, \"undefine\", null];\r\n\r\n        for (var i = 0; i < this.state.carres.length; i++) {\r\n            var place = this.state.carres[i];\r\n            var newPathRoute = await this.calculateRoute(origin, place);\r\n            var distance = newPathRoute.routes[0].legs[0].distance.text;\r\n            distance = parseFloat(distance.split(\" \")[0].replace(\",\", \".\"));\r\n            if (distance < theBestOriginToPlace[0]) {\r\n                theBestOriginToPlace[1] = place;\r\n                theBestOriginToPlace[0] = Math.min(distance, theBestOriginToPlace[0])\r\n                theBestOriginToPlace[2] = newPathRoute.routes[0].overview_path;\r\n            }\r\n        }\r\n        console.log(destination)\r\n        for (i = 0; i < this.state.carres.length; i++) {\r\n            place = this.state.carres[i];\r\n            //if(place === theBestOriginToPlace[1])continue;\r\n            try {\r\n                newPathRoute = await this.calculateRoute(destination, place);\r\n                distance = newPathRoute.routes[0].legs[0].distance.text;\r\n                distance = parseFloat(distance.split(\" \")[0].replace(\",\", \".\"));\r\n                if (distance < theBestDestinationToPlace[0]) {\r\n                    theBestDestinationToPlace[1] = place;\r\n                    theBestDestinationToPlace[0] = Math.min(distance, theBestDestinationToPlace[0])\r\n                    theBestDestinationToPlace[2] = newPathRoute.routes[0].overview_path;\r\n                }\r\n\r\n\r\n            } catch (error) {\r\n\r\n            }\r\n        }\r\n        console.log(theBestOriginToPlace[1], theBestDestinationToPlace[1])\r\n        newPathRoute = await this.calculateRoute(theBestDestinationToPlace[1], theBestOriginToPlace[1]);\r\n        this.setState({\r\n            pathRoute: newPathRoute.routes[0].overview_path,\r\n            pathRouteDestinationPlace: theBestDestinationToPlace[2],\r\n            pathRouteOriginPlace: theBestOriginToPlace[2],\r\n            open: false\r\n        });\r\n\r\n        var newJSON = JSON.stringify( {\r\n            origin : origin,\r\n            destination :  destination,\r\n            pathRouteDestinationPlace : theBestDestinationToPlace[1],\r\n            pathRouteOriginPlace : theBestOriginToPlace[1]\r\n        });\r\n\r\n        if (localStorage.getItem('lastroutes') === undefined || localStorage.getItem('lastroutes') === null ) {\r\n            localStorage.setItem('lastroutes', JSON.stringify([newJSON]))\r\n        }else{\r\n            var tdListJSON = []\r\n            var tdLists = JSON.parse(localStorage.getItem(\"lastroutes\"));\r\n            for(var i = 0 ; i < tdLists.length  ; ++i ){\r\n                tdListJSON.push(tdLists[i]);\r\n            } \r\n            tdListJSON.push(newJSON);\r\n            localStorage.setItem(\"lastroutes\",JSON.stringify(tdListJSON));\r\n        }\r\n\r\n\r\n        const places = [origin, destination, theBestDestinationToPlace[1], theBestOriginToPlace[1]]\r\n        this.setState({\r\n            markers: []\r\n        })\r\n        for (i = 0; i < 4; ++i) {\r\n            const latAndLng = await this.getLanLnt(places[i]);\r\n            const newMarker = {\r\n                university: { lat: latAndLng.lat(), lng: latAndLng.lng() },\r\n                title: places[i],\r\n                name: places[i],\r\n            }\r\n            this.state.markers.push(newMarker);\r\n        }\r\n        console.log(this.state.markers)\r\n\r\n        this.getCenterMap(origin, destination);\r\n\r\n    }\r\n\r\n\r\n    autocomplete() {\r\n        const { google, map } = this.props;\r\n        if (!google || !map) return;\r\n        var src = document.getElementById(\"source\");\r\n        var tgt = document.getElementById('target');\r\n        var autoSrc = new google.maps.places.Autocomplete(src);\r\n        var autoTgt = new google.maps.places.Autocomplete(tgt);\r\n        autoSrc.bindTo('bounds', map);\r\n        autoSrc.setFields(['address_components', 'geometry', 'icon', 'name']);\r\n        autoTgt.bindTo('bounds', map);\r\n        autoTgt.setFields(['address_components', 'geometry', 'icon', 'name']);\r\n\r\n        autoSrc.setComponentRestrictions(\r\n            { 'country': ['co'] });\r\n        autoTgt.setComponentRestrictions(\r\n            { 'country': ['co'] });\r\n\r\n\r\n    }\r\n\r\n\r\n    calculateRoute(origin, destination) {\r\n        const { google, map } = this.props;\r\n        if (!google || !map) return;\r\n        const directionsService = new google.maps.DirectionsService();\r\n        const request = {\r\n            origin: origin,\r\n            destination: destination,\r\n            travelMode: \"DRIVING\",\r\n            provideRouteAlternatives: true,\r\n        };\r\n        return new Promise((resolve, reject) => {\r\n            directionsService.route(request, (response, status) => {\r\n                if (status === 'OK') {\r\n                    console.log(response)\r\n                    resolve(response)\r\n                } else {\r\n                    window.alert(destination + \" ----- \" + origin)\r\n                    window.alert('Directions request failed due to ' + status);\r\n                    reject(status)\r\n                }\r\n            })\r\n        }\r\n        )\r\n    }\r\n\r\n\r\n    //https://stackoverflow.com/questions/26059762/callback-when-dom-is-loaded-in-react-js\r\n    componentDidMount() {\r\n        this.autocomplete();\r\n        if (navigator && navigator.geolocation) {\r\n            //navigator.geolocation.getCurrentPosition(this.setCurrentPosition)\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps) {\r\n        if (this.props.map !== prevProps.map) {\r\n            this.autocomplete();\r\n\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const { classes } = this.props;\r\n        const mark = this.state.markers.map((td) =>\r\n            <Marker\r\n                title={td.title}\r\n                position={td.university}\r\n                animation={this.props.google.maps.Animation.DROP}\r\n                name={td.name}\r\n                description={td.description}\r\n            />\r\n        );\r\n\r\n        return (\r\n            <div>\r\n                <SearchBar></SearchBar>\r\n\r\n                <Map\r\n                    className=\"map\"\r\n                    google={this.props.google}\r\n                    zoom={15}\r\n                    style={mapStyles}\r\n                    initialCenter={this.state.university}\r\n                    centerAroundCurrentLocation={false}\r\n                    mapTypeControl={false}\r\n                    center={this.state.position}\r\n\r\n                    >\r\n                    \r\n                    {mark}\r\n\r\n                    <Polyline\r\n                        path={this.state.pathRoute}\r\n                        geodesic={true}\r\n                        options={{\r\n                            strokeColor: '#354BD9',\r\n                            strokeOpacity: 1,\r\n                            strokeWeight: 2,\r\n\r\n                        }}\r\n                    />\r\n\r\n                    <Polyline\r\n                        path={this.state.pathRouteDestinationPlace}\r\n                        geodesic={true}\r\n                        options={{\r\n                            strokeColor: '#38B44F',\r\n                            strokeOpacity: 1,\r\n                            strokeWeight: 2,\r\n                        }}\r\n                    />\r\n\r\n                    <Polyline\r\n                        path={this.state.pathRouteOriginPlace}\r\n                        geodesic={true}\r\n                        options={{\r\n                            strokeColor: '#38B44F',\r\n                            strokeOpacity: 1,\r\n                            strokeWeight: 2,\r\n                        }}\r\n                    />\r\n\r\n                     <Fab id=\"fab\" color=\"primary\" aria-label=\"add\" className={classes.fab} >\r\n                        <NavigationIcon onClick={this.setDirectionRoute}/>\r\n                    </Fab>\r\n                    \r\n                </Map>\r\n            </div>\r\n        );\r\n    }\r\n\r\n}\r\n//https://es.reactjs.org/docs/hooks-reference.html#usestate\r\nMapComponent.propTypes = {\r\n    classes: PropTypes.object.isRequired,\r\n};\r\n\r\nconst MapWrapper = props => (\r\n    <div className=\"unAbsolute\">\r\n        <Map className=\"map\" google={props.google} visible={false}>\r\n            <MapComponent {...props} />\r\n        </Map>\r\n    </div>\r\n);\r\n\r\nexport default withStyles(useStyles)(GoogleApiWrapper({\r\n    apiKey: 'AIzaSyCJuZIQnX6XR1vs6dBHuZHj8J5TrWmVi-8',\r\n    language: \"es\",\r\n})(MapWrapper));"]},"metadata":{},"sourceType":"module"}